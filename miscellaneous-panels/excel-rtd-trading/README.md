---
description: Как экспортировать данные рынка в реальном времени в Exel
---

# Excel  RTD - данные в реальном  времени

Начиная с версии 1.39 Quantower поддерживает данные в реальном времени \(RTD\) для отправки данных и другой рыночной информации в Microsoft Excel®. Эта функция открывает множество возможностей для создания настраиваемых экранов и других способов более эффективного управления рабочим процессом.

{% embed url="https://youtu.be/k1pbtSadX8I" %}

> **RTD - это новый протокол**, который предлагает несколько преимуществ по сравнению с DDE, включая большую гибкость, лучшую производительность и надежность.

Используя **анализ данных в реальном режиме времени с помощью формулы RTD,** можно создать персональную аналитику данных, начиная от получения всех параметров котировок и заканчивая полноценным и глубоким анализом рынка в реальном режиме, с графиками и аналитикой. В данном разделе мы познакомим Вас с  основными возможностями, используя которые Вы сможете создать в  **Excel** свой пользовательский анализ данных в реальном режиме времени используя платформу **Quantower:**

* **Как активировать функцию RTD на платформе Quantower**
  * Как проверить разделитель аргументов?
* **Как получить данные в реальном режиме времени со списка наблюдения в Excel?** 
  * Получение данных путем копирования формулы
  * Получение данных путем написания формулы
* **Примеры самых популярных формул RTD с описанием**
  * **GetSymbolInfo** -доступ к информации о конкретном символе
  * **GetAccounInfo -** доступ к информации о конкретной учетной записи
  * 

## Как активировать функцию RTD на платформе Quantower

{% hint style="warning" %}
Для правильной работы функции платформа Quantower и Excel должны иметь одинаковую версию - 64 или 32 бит.
{% endhint %}

Запустите Excel, а затем откройте Диспетчер задач, чтобы проверить версию Excel \(32-разрядную или 64-разрядную\). Платформа должна иметь одну и ту же версию для правильной работы с функцией RTD.

![](../../.gitbook/assets/image%20%28150%29.png)

Зайдите в Общие настройки платформы, затем в раздел Excel RTD и отметьте «Включить Microsoft Excel RTD».

![&#x410;&#x43A;&#x442;&#x438;&#x432;&#x430;&#x446;&#x438;&#x44F; &#x444;&#x443;&#x43D;&#x43A;&#x446;&#x438;&#x438; RTD](../../.gitbook/assets/eksport-v-eksel.png)

Также в настройках есть две важные настройки:

* **Пользовательское название формулы RTD** - в зависимости от языка вашей операционной системы имя функции RTD в Excel может называться по-разному. Первоначальное название функции в английской версии Excel - RTD, а в русской версии - **«ДРВ»**.
* **Пользовательский разделитель аргументов** - разделитель, участвующий в формуле. Это зависит от локализации вашей операционной системы. 

### **Как проверить разделитель аргументов?**

Для Windows 10:

* перейдите в Пуск&gt; введите Панель управления и нажмите ввод&gt; **Регион**
* нажмите **Дополнительные настройки**
* для разделителя списка проверьте аргумент.  Он должен быть таким же, как в настройках RTD.

![](../../.gitbook/assets/izmenit-razdelitel.png)

{% hint style="success" %}
После активации RTD в  панели **"Список наблюдения" и в таблицах,** появится дополнительный пункт в контекстном меню - **скопировать формулу RTD.**
{% endhint %}

## **Как получить данные в реальном режиме времени со списка наблюдения в Excel?**

### 1. Получение данных путем копирования формулы

Самый простой способ получить данные в Excel - скопировать необходимые данные через контекстное меню панели. Например, после активации RTD в панели ["Список наблюдения"](https://help.quantower.com.ru/analytics-panels/watchlist) появится дополнительный пункт в контекстном меню - скопировать формулу RTD.

* Выберите необходимый символ или несколько символов, щелкните правой кнопкой мыши и выберите **«Копировать формулу RTD»**. Вы можете копировать формулы для определенных столбцов или для всех столбцов.
* Если Вы хотите **скопировать сразу готовую таблицу с данными**, добавьте в список наблюдения все необходимые данные \(столбцы с аналитическими данными по символу\) которые Вы планируете использовать  для последующего анализа в Excel и выделите все строки для вашей будущей таблицы Excel. 

> Зажав клавишу "Shift" можно выделить сразу несколько строк, зажав клавишу "Ctrl" выборочно.

![](../../.gitbook/assets/kopiya-formuly.png)

* Зайдите в Excel и вставьте скопированные формулы. Теперь данные будут обновляться автоматически.

![&#x41F;&#x43E;&#x43B;&#x443;&#x447;&#x435;&#x43D;&#x438;&#x435; &#x434;&#x430;&#x43D;&#x43D;&#x44B;&#x445; &#x432; &#x440;&#x435;&#x430;&#x43B;&#x44C;&#x43D;&#x43E;&#x43C; &#x432;&#x440;&#x435;&#x43C;&#x435;&#x43D;&#x438; &#x432; Excel](../../.gitbook/assets/rtd-quick-copying.gif)

{% hint style="info" %}
Вы можете заметить, что данные обновляются с некоторой задержкой. **Это скорость обновления, установленная по умолчанию в Excel \(2000 миллисекунд\).** Если вы хотите увеличить [скорость обновления данных, прочтите инструкцию, как это сделать.](https://help.quantower.com/miscellaneous-panels/excel-rtd-trading/changing-rtd-throttle-interval-in-excel)
{% endhint %}

### 2. Получение данных путем написания формулы

При получении данных определенных параметров с помощью RTD, вам необходимо указать идентификатор параметра и свойства, которые вы хотите получить.

Формула RTD использует следующую базовую структуру:

```text
=RTD("TradingPlatform";"";"Param1";"Param2";"Param3";....")
```

{% hint style="info" %}
Второй параметр - это имя внешнего сервера, на котором запущен сервер RTD. Поскольку сервер Quantower RTD всегда работает локально, вы должны опустить значение для второго параметра или указать пустую строку \(«»\). Однако вы должны учитывать параметр в формуле.
{% endhint %}

## **Примеры самых популярных формул RTD с описанием**

Ниже описаны примеры **самых популярных формул RTD с описанием основного синтаксиса**.  Используя их, можно получить именно те данные, которые нужны для анализа и вставить в свою электронную таблицу. Так же Вы можете данные примеры загрузить с[ **данного файла Excel.**](https://updates.quantower.com/misc/RTD/rtd_samples.xlsx)\*\*\*\*

### GetSymbolInfo -доступ к информации о конкретном символе

{% hint style="success" %}
Предоставляет доступ к информации о конкретном символе, такой как **Description, ExchangeName, NettingType и других.** Вы можете просто скопировать / вставить эту формулу для использования в файлах Excel или получить ее прямо из панели «Информация о символе» для выбранного символа. Щелкните правой кнопкой мыши на панели и выберите пункт меню: _**«Копировать формулу RTD» -&gt; «Значение».**_
{% endhint %}

**Синтаксис:**

```text
=RTD("TradingPlatform";"";"GetSymbolInfo";"AUD_USD";"SymbolType";"Emulator")
```

_**Параметры**_

| _**Параметр**_ | Описание |
| :--- | :--- |
| **"TradingPlatform"** | Имя сервера Quantower RTD. Вы можете использовать его во всех формулах. |
| **"GetSymbolInfo"** | Название метода |
| **"AUD\_USD"** | ID символа, данные по которому вы хотите получить. Вы можете получить его из панели SymbolInfo. |
| **"SymbolType"** | Указанный тип данных, которые вы хотите получать.  Например: Имя, Описание. |
| **"Emulator"** | Имя соединения, которое вы хотите использовать для поиска нужного символа. Вы можете оставить этот параметр пустым, если у вас только одно соединение. |

### GetAccounInfo - доступ к информации о конкретной учетной записи

{% hint style="success" %}
Предоставляет доступ к информации о конкретной учетной записи, такой как имя, баланс, NettingType и другие. Вы можете просто скопировать / вставить эту формулу для использования в файлах Excel или получить ее непосредственно из панели «Информация об учетной записи» для выбранной учетной записи. Щелкните правой кнопкой мыши на панели и выберите пункт меню: «Копировать формулу RTD» -&gt; «Значение».
{% endhint %}



