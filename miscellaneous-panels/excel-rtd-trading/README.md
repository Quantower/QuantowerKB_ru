---
description: Как экспортировать данные рынка в реальном времени в Exel
---

# Excel  RTD - данные в реальном  времени

Начиная с версии 1.39 Quantower поддерживает данные в реальном времени \(RTD\) для отправки данных и другой рыночной информации в Microsoft Excel®. Эта функция открывает множество возможностей для создания настраиваемых экранов и других способов более эффективного управления рабочим процессом.

{% embed url="https://youtu.be/k1pbtSadX8I" %}

> **RTD - это новый протокол**, который предлагает несколько преимуществ по сравнению с DDE, включая большую гибкость, лучшую производительность и надежность.

Используя **анализ данных в реальном режиме времени с помощью формулы RTD,** можно создать персональную аналитику данных, начиная от получения всех параметров котировок и заканчивая полноценным анализом рынка в реальном режиме, с графиками, и финансовым анализом. В данном разделе мы познакомим Вас с  основными возможностями, используя которые Вы сможете создать в  **Excel** свой пользовательский анализ данных в реальном режиме времени используя платформу **Quantower:**

* \*\*\*\*[**Как активировать функцию RTD на платформе Quantower**](./#kak-aktivirovat-funkciyu-rtd-na-platforme-quantower)\*\*\*\*
  * [Как проверить разделитель аргументов?](./#kak-proverit-razdelitel-argumentov)
* \*\*\*\*[**Как получить данные в реальном режиме времени со списка наблюдения в Excel?** ](./#kak-poluchit-dannye-v-realnom-rezhime-vremeni-so-spiska-nablyudeniya-v-excel)\*\*\*\*
  * [Получение данных путем копирования формулы](./#1-poluchenie-dannykh-putem-kopirovaniya-formuly)
  * [Получение данных путем написания формулы](./#2-poluchenie-dannykh-putem-napisaniya-formuly)
* \*\*\*\*[**Примеры самых популярных формул RTD с описанием**](./#primery-samykh-populyarnykh-formul-rtd-s-opisaniem)         ****[**1. GetSymbolInfo** - информация о конкретном символе](./#getsymbolinfo-informaciya-o-konkretnom-simvole)         [**2. GetAccounInfo -** информация о конкретной учетной записи](./#getaccouninfo-informaciya-o-konkretnoi-uchetnoi-zapisi)         **3.** [**GetMarketData -** данные символа Bid, Ask, Last, Open, High и т. д](./#getmarketdata-dannye-simvola-bid-ask-last-open-high-i-t-d)         **4.** [**GetLevel2Data  -** Level2 данные глубины рынка ](./#getlevel-2-data-level2-dannye-glubiny-rynka)         **5.** [**GetHistory** - история для указанного символа ](./#gethistory-istoriya-dlya-ukazannogo-simvola)

## Как активировать функцию RTD на платформе Quantower

{% hint style="warning" %}
Для правильной работы функции платформа Quantower и Excel должны иметь одинаковую версию - 64 или 32 бит.
{% endhint %}

Запустите Excel, а затем откройте Диспетчер задач, чтобы проверить версию Excel \(32-разрядную или 64-разрядную\). Платформа должна иметь одну и ту же версию для правильной работы с функцией RTD.

![](../../.gitbook/assets/image%20%28150%29.png)

Зайдите в Общие настройки платформы, затем в раздел Excel RTD и отметьте «Включить Microsoft Excel RTD».

![&#x410;&#x43A;&#x442;&#x438;&#x432;&#x430;&#x446;&#x438;&#x44F; &#x444;&#x443;&#x43D;&#x43A;&#x446;&#x438;&#x438; RTD](../../.gitbook/assets/eksport-v-eksel.png)

Также в настройках есть две важные настройки:

* **Пользовательское название формулы RTD** - в зависимости от языка вашей операционной системы имя функции RTD в Excel может называться по-разному. Первоначальное название функции в английской версии Excel - RTD, а в русской версии - **«ДРВ»**.
* **Пользовательский разделитель аргументов** - разделитель, участвующий в формуле. Это зависит от локализации вашей операционной системы. 

### **Как проверить разделитель аргументов?**

Для Windows 10:

* перейдите в Пуск&gt; введите Панель управления и нажмите ввод&gt; **Регион**
* нажмите **Дополнительные настройки**
* для разделителя списка проверьте аргумент.  Он должен быть таким же, как в настройках RTD.

![](../../.gitbook/assets/izmenit-razdelitel.png)

{% hint style="success" %}
После активации RTD в  панели **"Список наблюдения" и в таблицах,** появится дополнительный пункт в контекстном меню - **скопировать формулу RTD.**
{% endhint %}

## **Как получить данные в реальном режиме времени со списка наблюдения в Excel?**

### 1. Получение данных путем копирования формулы

Самый простой способ получить данные в Excel - скопировать необходимые данные через контекстное меню панели. Например, после активации RTD в панели ["Список наблюдения"](https://help.quantower.com.ru/analytics-panels/watchlist) появится дополнительный пункт в контекстном меню - скопировать формулу RTD.

* Выберите необходимый символ или несколько символов, щелкните правой кнопкой мыши и выберите **«Копировать формулу RTD»**. Вы можете копировать формулы для определенных столбцов или для всех столбцов.
* Если Вы хотите **скопировать сразу готовую таблицу с данными**, добавьте в список наблюдения все необходимые данные \(столбцы с аналитическими данными по символу\) которые Вы планируете использовать  для последующего анализа в Excel и выделите все строки для вашей будущей таблицы Excel. 

> Зажав клавишу "Shift" можно выделить сразу несколько строк, зажав клавишу "Ctrl" выборочно.

![](../../.gitbook/assets/kopiya-formuly.png)

* Зайдите в Excel и вставьте скопированные формулы. Теперь данные будут обновляться автоматически.

![&#x41F;&#x43E;&#x43B;&#x443;&#x447;&#x435;&#x43D;&#x438;&#x435; &#x434;&#x430;&#x43D;&#x43D;&#x44B;&#x445; &#x432; &#x440;&#x435;&#x430;&#x43B;&#x44C;&#x43D;&#x43E;&#x43C; &#x432;&#x440;&#x435;&#x43C;&#x435;&#x43D;&#x438; &#x432; Excel](../../.gitbook/assets/rtd-quick-copying.gif)

{% hint style="info" %}
Вы можете заметить, что данные обновляются с некоторой задержкой. **Это скорость обновления, установленная по умолчанию в Excel \(2000 миллисекунд\).** Если вы хотите увеличить [скорость обновления данных, прочтите инструкцию, как это сделать.](https://help.quantower.com/miscellaneous-panels/excel-rtd-trading/changing-rtd-throttle-interval-in-excel)
{% endhint %}

### 2. Получение данных путем написания формулы

При получении данных определенных параметров с помощью RTD, вам необходимо указать идентификатор параметра и свойства, которые вы хотите получить.

Формула RTD использует следующую базовую структуру:

```text
=ДРВ("TradingPlatform";"";"Param1";"Param2";"Param3";....")
```

{% hint style="info" %}
Второй параметр - это имя внешнего сервера, на котором запущен сервер RTD. Поскольку сервер Quantower RTD всегда работает локально, вы должны опустить значение для второго параметра или указать пустую строку \(«»\). Однако вы должны учитывать параметр в формуле.
{% endhint %}



## **Примеры самых популярных формул RTD с описанием**

Ниже описаны примеры **самых популярных формул RTD с описанием основного синтаксиса** на примере биржи Binance. Используя их, можно получить именно те данные, которые нужны для анализа и вставить в свою электронную таблицу. Так же Вы можете данные примеры загрузить с[ **данного файла Excel.**](https://updates.quantower.com/misc/RTD/rtd_samples.xlsx)\*\*\*\*

\*\*\*\*

### 1.GetSymbolInfo - информация о конкретном символе

{% hint style="success" %}
Предоставляет доступ к информации о конкретном символе, такой как **Description, ExchangeName, NettingType и других.** Вы можете просто скопировать / вставить эту формулу для использования в файлах Excel или получить ее прямо из панели «Информация о символе» для выбранного символа. Щелкните правой кнопкой мыши на панели и выберите пункт меню: _**«Копировать формулу RTD» -&gt; «Значение».**_
{% endhint %}

```text
=ДРВ("TradingPlatform";"";"GetSymbolInfo";"BTCUSDT";"SymbolType";"Binance")
```

_**Параметры**_

| _**Параметр**_ | Описание |
| :--- | :--- |
| **"TradingPlatform"** | Имя сервера Quantower RTD. Вы можете использовать его во всех формулах. |
| **"GetSymbolInfo"** | Название метода |
| **"AUD\_USD"** | ID символа, данные по которому вы хотите получить. Вы можете получить его из панели SymbolInfo. |
| **"SymbolType"** | Указанный тип данных, которые вы хотите получать.  Например: Имя, Описание. |
| **"Emulator"** | Имя соединения, которое вы хотите использовать для поиска нужного символа. Вы можете оставить этот параметр пустым, если у вас только одно соединение.  |

![](../../.gitbook/assets/eksel-kripto1.gif)

### 2. GetAccounInfo - информация о конкретной учетной записи

{% hint style="success" %}
Предоставляет доступ к информации о конкретной учетной записи, такой как имя, баланс, NettingType и другие. Вы можете просто скопировать / вставить эту формулу для использования в файлах Excel или получить ее непосредственно из панели «Информация об учетной записи» для выбранной учетной записи. Щелкните правой кнопкой мыши на панели и выберите пункт меню: «Копировать формулу RTD» -&gt; «Значение».
{% endhint %}

```text
 =ДРВ("TradingPlatform";"";"GetAccountInfo";"BTCUSDT";"Balance";"Binance")
```

_**Параметры**_

| _**Параметр**_ | _Описание_ |
| :--- | :--- |
| **"TradingPlatform"** | Имя сервера Quantower RTD. Вы можете использовать его во всех формулах. |
| **"GetAccountInfo"** | Название метода |
| **"BTCUSDT"** | ID символа, данные по которому вы хотите получить. Вы можете получить его из панели SymbolInfo.   |
| **"Balance"** | Указанный тип данных, которые вы хотите получать. Например: Name, Description. Allowed order types |
| **"Emulator"** | Имя соединения, которое вы хотите использовать для поиска нужного символа. Вы можете оставить этот параметр пустым, если у вас только одно соединение. |



### 3. GetMarketData - данные символа Bid, Ask, Last, Open, High и т. д

{% hint style="success" %}
Предоставляет доступ к информации обо всех типах рыночных данных, доступных для конкретного символа: Bid, Ask, Last, Open, High и т. д. Вы можете просто скопировать / вставить эту формулу для использования в файлах Excel или получить ее непосредственно из панели «Список наблюдения» для выбранных символов.
{% endhint %}

```text
 =ДРВ("TradingPlatform";"";"GetMarketData";"AUD_USD";"Bid";"Emulator")
```

_**Параметры**_

| _**Параметр**_ | _Описание_ |
| :--- | :--- |
| **"TradingPlatform"** | Имя сервера Quantower RTD. Вы можете использовать его во всех формулах. |
| **"GetMarketData"** | Название метода |
| **"AUD\_USD"** | ID символа, данные по которому вы хотите получить. Вы можете получить его из панели SymbolInfo. |
| **"Bid"** | Указанный тип данных, которые вы хотите получать. Например: Bid, Ask, Last, Open, High |
| **"Emulator"** | Имя соединения, которое вы хотите использовать для поиска нужного символа. Вы можете оставить этот параметр пустым, если у вас только одно соединение. |

### 4. GetLevel2Data - Level2 данные глубины рынка 

{% hint style="success" %}
Предоставляет доступ к данным Уровня 2 для определенного символа. Вы можете просто скопировать / вставить эту формулу и использовать ее в файлах Excel.
{% endhint %}

```text
 =ДРВ("TradingPlatform";"";"GetLevel2Data";"AUD_USD";"Bid";"0";"Emulator")
```

_**Параметры**_

| _**Параметр**_ | _Описание_ |
| :--- | :--- |
| **"TradingPlatform"** | Имя сервера Quantower RTD. Вы можете использовать его во всех формулах. |
| **"GetLevel2Data"** | Название метода |
| **"AUD\_USD"** | ID символа, данные по которому вы хотите получить. Вы можете получить его из панели SymbolInfo. |
| **"Bid"** | Указанный тип данных, которые вы хотите получать. Например: Bid, Ask, BidSize, AskSize. |
| **"0"** | Порядковый номер уровня в стакане цен. Начинается с 0. |
| **"Emulator"** | Имя соединения, которое вы хотите использовать для поиска нужного символа. Вы можете оставить этот параметр пустым, если у вас только одно соединение. |



### 5. GetHistory - история для указанного символа 

{% hint style="success" %}
Возвращает историю для указанного символа, агрегирования и диапазона дат. Вы можете просто скопировать / вставить эту формулу и использовать ее в файлах Excel.
{% endhint %}

```text
 =ДРВ("tradingplatform";"";"GetHistory";"AUD_USD";"1Day";"Close";"10Day";"0";"Bid";"Emulator")
```

_**Параметры**_

| _**Параметр**_ | _Описание_ |
| :--- | :--- |
| **"TradingPlatform"** | Имя сервера Quantower RTD. Вы можете использовать его во всех формулах. |
| **"GetHistory"** | Название метода |
| **"AUD\_USD"** | ID символа, данные по которому вы хотите получить. Вы можете получить его из панели SymbolInfo. |
| **"1Day"** | Тип агрегирования: 1 день, 3 дня, 5 минут и т. д. Доступные агрегаты:Tick, Second, Minute, Hour, Day, Week, Month, Year. |
| **"Close"** | Указанный тип данных, которые вы хотите получать. Например: Open, High, Low, Close, Volume, Bid, Ask. |
| **"10Day"** | Требуемый диапазон истории: 10 дней, 300 минут и т. д. Доступные диапазоны: Minute, Hour, Day, Month, Year. |
| **"0"** | Индекс бара / тика в возвращаемом массиве истории. 0 означает самый новый бар. |
| **"Bid"** | Тип истории Bid, Ask, Last. Оставьте поле пустым, чтобы получать историю по умолчанию для указанного символа. |
| **"Emulator"** | Имя соединения, которое вы хотите использовать для поиска нужного символа. Вы можете оставить этот параметр пустым, если у вас только одно соединение. |

